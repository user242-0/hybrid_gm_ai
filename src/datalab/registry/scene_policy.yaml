defaults:
  camera:   { shot: "mid", lens_mm: 50 }
  lighting: { key: "torch_warm", fill: "low" }
  background: "stone corridor"

rules:
  # (より具体) 祭壇でのswing_sword
  - when: { action: "swing_sword", location: "祭壇" }
    theme: "祭壇での稽古"
    background: "ancient altar under moonlight"
    loras: ["ferlon_style_v1"]
    objects:
      - name: "{actor}"
        category: "character"
        base_prompt: "chibi knight in plate armor"
        action: "swing_sword"
        pose: { kind: "skeleton", ref: "controls/poses/swing_A.json" }
        materials_hint: ["steel_brushed","leather_soft"]

  # (汎用) 場所・時間を問わず swing_sword（最後に置く＝フォールバック）
  - when: { action: "swing_sword" }
    theme: "剣の稽古"
    background: "torch-lit stone corridor"
    loras: ["ferlon_style_v1"]
    objects:
      - name: "{actor}"
        category: "character"
        base_prompt: "knight in plate armor"
        action: "swing_sword"
        pose: { kind: "skeleton", ref: "controls/poses/swing_A.json" }
        materials_hint: ["steel_brushed","leather_soft"]


  - when: { action: "攻撃する", relation_label: "敵対" }
    camera: { shot: "close" }
    loras:  ["gritty_v2"]

  # どちらか一方（推奨：正規化名で統一）
  - when: { action: "talk_to_statue", location: "祭壇" }
    theme: "月下の祭壇"
    background: "ancient altar under moonlight"
    camera: { shot: "mid" }
    loras: ["mystic_soft_v1"]
    objects:
      - name: "{actor}"
        category: "character"
        base_prompt: "pilgrim speaking to an ancient statue"
        action: "talk_to_statue"
  # 両対応にしたいなら:
  # - when: { action: ["talk_to_statue","石像に話す"], location: "祭壇" }